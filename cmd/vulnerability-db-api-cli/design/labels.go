/*
Copyright 2020 Adevinta
*/

package design

import (
	. "goa.design/goa/v3/dsl"
)

var LabelsResult = ResultType("labels", func() {
	Attributes(func() {
		Attribute("labels", ArrayOf(String), "List of labels", func() {
			Example([]string{"Web", "HTTP", "TLS"})
		})
	})
})

var _ = Service("labels", func() {
	Description("Labels endpoint.")

	Method("List labels", func() {
		Payload(func() {
			Field(1, "team", String, "Team of associated targets")
			Field(2, "tag", String, "Tag of associated targets")
			Field(3, "status", String, "Status of associated findings")
			Field(4, "atDate", String, "Allows to get the list of associated findings for a specific date (YYYY-MM-DD). This filter has preference over minDate and maxDate.")
			Field(5, "minDate", String, "Minimum date filter for associated findings (YYYY-MM-DD). This filter only applies when used in conjunction with status filter.")
			Field(6, "maxDate", String, "Maximum date filter for associated findings (YYYY-MM-DD). This filter only applies when used in conjunction with status filter.")
			Field(7, "identifiers", String, "A list of asset identifiers to filter by for associated targets")
		})

		Result(LabelsResult)

		HTTP(func() {
			GET("/labels")

			Param("team")
			Param("tag")
			Param("status")
			Param("atDate")
			Param("minDate")
			Param("maxDate")
			Param("identifiers")

			Response(StatusOK)
		})
	})
})
