# Copyright 2020 Adevinta

- id: c6a1099c-6141-415c-8fd8-30d68aedb90c
  summary: Mozilla HTTP Observatory
  cwe_id: 0
  description: The Mozilla HTTP Observatory is a set of tools to analyze your website and inform you if you are utilizing the many available methods to secure it. Some of the HTTP check results shown in this report come from using this tool. As the tool is giving a global score, we are showing it to you too. 
  recommendations: RAW=ARRAY['Fix all the vulnerabilities reported for the HTTP headers of your website to improve the score.']
  reference_links: RAW=ARRAY['https://github.com/mozilla/http-observatory/blob/master/httpobs/docs/scoring.md', 'https://observatory.mozilla.org/']

- id: 949da1f1-024e-4b9f-b2f1-9eabb4c2cabb
  summary: IPv6 presence
  cwe_id: 0
  description: This check tests for IPv6 presence on domain names. If AAAA DNS RR is present, people should be aware of that.It also serves as a way to monitor IPv6 deployed state.
  recommendations: RAW=ARRAY['Having IPv6 present is not a security vulnerability, just extra care has to be taken to also consider security services available over IPv6']
  reference_links: RAW=ARRAY['https://www.ietf.org/rfc/rfc2460.txt']

- id: c10c3b0b-2dca-4b1d-a9b5-766bc0414e35
  summary: HTTP Content Security Policy Not Implemented
  cwe_id: 358
  description: Content Security Policy (CSP) is an HTTP header that allows site operators fine-grained control over where resources on their site can be loaded from. The use of this header is the best method to prevent cross-site scripting (XSS) vulnerabilities. Due to the difficulty in retrofitting CSP into existing websites, CSP is mandatory for all new websites and is strongly recommended for all existing high-risk sites.
  recommendations: RAW=ARRAY['Implement a well-formed and correct CSP policy for this site.', 'The policy should not contain unsafe directive for anything but style.', 'The policy should not allow to load content from an insecure scheme (only https).']
  reference_links: RAW=ARRAY['https://wiki.mozilla.org/Security/Guidelines/Web_Security#Content_Security_Policy', 'https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP', 'https://content-security-policy.com/', 'https://observatory.mozilla.org/']

- id: 6a553190-9e12-4df8-9af2-090186f12c34
  summary: HTTP X-Content-Type-Options Not Implemented
  cwe_id: 358
  description: \`X-Content-Type-Options\` is a header supported by Internet Explorer, Chrome and Firefox 50+ that tells it not to load scripts and stylesheets unless the server indicates the correct MIME type. Without this header, these browsers can incorrectly detect files as scripts and stylesheets, leading to XSS attacks.
  recommendations: RAW=ARRAY['All sites must set the X-Content-Type-Options header and the appropriate MIME types for files that they serve.']
  reference_links: RAW=ARRAY['https://wiki.mozilla.org/Security/Guidelines/Web_Security#X-Content-Type-Options', 'https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options', 'https://observatory.mozilla.org/']

- id: 0335fc86-582a-4710-8edc-3983611d3a12
  summary: TLS NPN Supported Protocol Enumeration
  cwe_id: 0
  description: >
    The remote host supports the TLS NPN (Transport Layer Security Next
    Protocol Negotiation) extension. This plugin enumerates the protocols
    the extension supports.
  recommendations: RAW=ARRAY['n/a']
  reference_links: RAW=ARRAY['https://tools.ietf.org/id/draft-agl-tls-nextprotoneg-03.html']

- id: 52b71a0c-0431-4f98-a73f-9dd91c45706c
  summary: Cipher Suite Ordering Not Enforced
  cwe_id: 326
  description: This site does not enforce a specific priority order for its supported ciphersuites.
  recommendations: RAW=ARRAY['Enforce server side ordering']
  reference_links: RAW=ARRAY['https://wiki.mozilla.org/Security/Server_Side_TLS']

- id: 1148c8de-0af8-447a-a93e-f3bd274fa6a0
  summary: HTTP X-Frame-Options Not Implemented
  cwe_id: 358
  description: \`X-Frame-Options\` is an HTTP header that allows sites control over how your site may be framed within an iframe. Clickjacking is a practical attack that allows malicious sites to trick users into clicking links on your site even though they may appear to not be on your site at all. As such, the use of the \`X-Frame-Options\` header is mandatory for all new websites, and all existing websites are expected to add support for \`X-Frame-Options\` as soon as possible.
  recommendations: RAW=ARRAY['Sites that require the ability to be iframed must use either Content Security Policy and/or employ JavaScript defenses to prevent clickjacking from malicious origins.']
  reference_links: RAW=ARRAY['https://wiki.mozilla.org/Security/Guidelines/Web_Security#X-Frame-Options', 'https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options', 'https://observatory.mozilla.org/']

- id: 042d06f6-7027-4509-81ec-c919ae94677a
  summary: Weak SSL/TLS Protocol Versions
  cwe_id: 326
  description: This site supports one or more SSL/TLS protocol versions with known security weakenesses.
  recommendations: RAW=ARRAY['Consider client compatibility before remediating this vulnerability', 'Disable support for the weak protocol versions in your SSL/TLS terminator', 'Use the Mozilla tool in the resources to easily generate a strong configuration']
  reference_links: RAW=ARRAY['https://wiki.mozilla.org/Security/Server_Side_TLS', 'https://mozilla.github.io/server-side-tls/ssl-config-generator/']

- id: 03ec7d8c-0975-4e37-8dbd-becfe9053efe
  summary: Varnish Cache Exposed
  cwe_id: 0
  description: The asset appears to be a Varnish Cache, as the X-Cache header is present and the varnish literal has been found in the response.
  recommendations: 
  reference_links: 

- id: 7a590fe7-fb05-42f9-86fe-f8d0bb0f3d9f
  summary: Web Cache Exposed
  cwe_id: 0
  description: The asset appears to be a Web Cache, as the X-Cache HTTP header is present in the HTTP response.
  recommendations: 
  reference_links: 

- id: 36bc8869-45be-4abb-876f-965d21ee9976
  summary: Certificate Signed With Weak Algorithm
  cwe_id: 326
  description: The algorithm used to sign the certificate for this site has known weakenesses.
  recommendations: RAW=ARRAY['Use a certificate signed with ecdsa-with-SHA256 or ecdsa-with-SHA384 or ecdsa-with-SHA512']
  reference_links: RAW=ARRAY['https://wiki.mozilla.org/Security/Server_Side_TLS']

- id: 2a4d227a-6a24-4927-a162-df423939c010
  summary: HTTP Strict Transport Security Misconfiguration
  cwe_id: 358
  description: HTTP Strict Transport Security (HSTS) is an HTTP header that notifies user agents to only connect to a given site over HTTPS, even if the scheme chosen was HTTP. Browsers that have had HSTS set for a given site will transparently upgrade all requests to HTTPS. HSTS also tells the browser to treat TLS and certificate-related errors more strictly by disabling the ability for users to bypass the error page.
  recommendations: RAW=ARRAY['max-age must be set to a minimum of six months (15768000), but longer periods such as two years (63072000) are recommended. Note that once this value is set, the site must continue to support HTTPS until the expiry time has been reached.']
  reference_links: RAW=ARRAY['https://wiki.mozilla.org/Security/Guidelines/Web_Security#HTTP_Strict_Transport_Security', 'https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security', 'https://observatory.mozilla.org/']

- id: 4c10f1a0-b56c-4efa-8564-1e174def7fa0
  summary: Site Without HTTPS
  cwe_id: 358
  description: Websites may continue to listen on port 80 (HTTP) so that users do not get connection errors when typing a URL into their address bar, as browsers currently connect via HTTP for their initial request. Sites that listen on port 80 should only redirect to the same resource on HTTPS. Once the redirection has occured, HSTS should ensure that all future attempts go to the site via HTTP are instead sent directly to the secure site. APIs or websites not intended for public consumption should disable the use of HTTP entirely.
  recommendations: RAW=ARRAY['Redirect HTTP version of the site to HTTPS.', 'HTTP to HTTPS redirections should be done with the 301 redirects, unless they redirect to a different path, in which case they may be done with 302 redirections.', 'Sites should avoid redirections from HTTP to HTTPS on a different host, as this prevents HSTS from being set.', 'Serve the site via HTTPS instead of HTTP.']
  reference_links: RAW=ARRAY['https://wiki.mozilla.org/Security/Guidelines/Web_Security#HTTP_Redirections', 'https://developer.mozilla.org/en-US/docs/Web/HTTP/Redirections', 'https://observatory.mozilla.org/', 'https://security.googleblog.com/2018/02/a-secure-web-is-here-to-stay.html']

- id: e9eec1ed-5ce2-4633-bfc7-1f02da0e87e9
  summary: Exposed HTTP Port
  cwe_id: 0
  description: An HTTP server is listening at least in one port ot the server.
  recommendations: 
  reference_links: 

- id: 8e4fec18-ca31-402f-9857-2649eee0dc23
  summary: HTTP Strict Transport Security Not Implemented
  cwe_id: 358
  description: HTTP Strict Transport Security (HSTS) is an HTTP header that notifies user agents to only connect to a given site over HTTPS, even if the scheme chosen was HTTP. Browsers that have had HSTS set for a given site will transparently upgrade all requests to HTTPS. HSTS also tells the browser to treat TLS and certificate-related errors more strictly by disabling the ability for users to bypass the error page.
  recommendations: RAW=ARRAY['Implement HSTS in the site.']
  reference_links: RAW=ARRAY['https://wiki.mozilla.org/Security/Guidelines/Web_Security#HTTP_Strict_Transport_Security', 'https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security', 'https://observatory.mozilla.org/']

- id: 488d0001-9bd0-4a12-84b6-d60397a1ddb9
  summary: Service Detection
  cwe_id: 0
  description: >
    Nessus was able to identify the remote service by its banner or by
    looking at the error message it sends when it receives an HTTP
    request.
  recommendations: RAW=ARRAY['n/a']
  reference_links: 

- id: afef6b0f-8f25-4388-a6d0-91f251b90c5f
  summary: SSL Certificate Information
  cwe_id: 0
  description: >
    This plugin connects to every SSL-related port and attempts to 
    extract and dump the X.509 certificate.
  recommendations: RAW=ARRAY['n/a']
  reference_links: 

- id: 15a23e1a-688c-4362-93ef-6584cc50435f
  summary: Host Fully Qualified Domain Name (FQDN) Resolution
  cwe_id: 0
  description: >
    Nessus was able to resolve the fully qualified domain name (FQDN) of
    the remote host.
  recommendations: RAW=ARRAY['n/a']
  reference_links: 

- id: 8dc8c728-15c4-406c-8dfb-50de0495bdd2
  summary: AWS IAM Access Key Rotation
  cwe_id: 0
  description: >
    Checks for active IAM access keys that have not been rotated in the last 90 days.  When you rotate your access keys regularly, you reduce the chance that a compromised key could be used without your knowledge to access resources. For the purposes of this check, the last rotation date and time is when the access key was created or most recently activated. The access key number and date come from the <b>access_key_1_last_rotated</b> and <b>access_key_2_last_rotated</b> information in the most recent IAM credential report. Because the regeneration frequency of a credential report  is restricted, refreshing this check might not reflect recent changes (for details, see <a target="_blank" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_getting-report.html">Getting Credential Reports for Your AWS Account</a>).<br/>
    In order to create and rotate access keys, a user must have the appropriate permissions. For more information, see <a target="_blank" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_delegate-permissions_examples.html#creds-policies-credentials">Allow Users to Manage Their Own Passwords, Access Keys, and SSH Keys</a>.<br/><br/>
    <b>Alert Criteria</b><br/>
    Green: The access key is active and has been rotated in the last 90 days.<br/>
    Yellow: The access key is active and has been rotated in the last 2 years, but more than 90 days ago.<br/>
    Red: The access key is active and has not been rotated in the last 2 years.<br/><br/>

  recommendations: RAW=ARRAY['Rotate access keys on a regular basis. See <a target="_blank" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html#Using_RotateAccessKey">Rotating Access Keys</a> and <a target="_blank" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html">Managing Access Keys for IAM Users</a>.']
  reference_links: RAW=ARRAY['https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html', 'https://blogs.aws.amazon.com/security/post/Tx15CIT22V4J8RP/How-to-rotate-access-keys-for-IAM-users']

- id: f9899b73-5203-4e07-943a-cde1ad81278b
  summary: Missing Strong SSL/TLS Protocol Versions
  cwe_id: 326
  description: This site does not support one or more SSL/TLS protocol versions considered to be strong.
  recommendations: RAW=ARRAY['Enable support for the strong SSL/TLS protocol versions in your SSL/TLS terminator', 'Use the Mozilla tool in the resources to easily generate a strong configuration']
  reference_links: RAW=ARRAY['https://wiki.mozilla.org/Security/Server_Side_TLS', 'https://mozilla.github.io/server-side-tls/ssl-config-generator/']

- id: de46679a-b767-4dbd-909a-9b2bc5d647f9
  summary: TLS Next Protocols Supported
  cwe_id: 0
  description: >
    This script detects which protocols are advertised by the remote
    service to be encapsulated by TLS connections.

    Note that Nessus did not attempt to negotiate TLS sessions with the
    protocols shown.  The remote service may be falsely advertising these
    protocols and / or failing to advertise other supported protocols.
  recommendations: RAW=ARRAY['n/a']
  reference_links: RAW=ARRAY['https://tools.ietf.org/html/draft-agl-tls-nextprotoneg-04', 'https://technotes.googlecode.com/git/nextprotoneg.html']

- id: 8410bfed-c927-404b-ac42-e1c276b9a703
  summary: TLS Version 1.0 Protocol Detection
  cwe_id: 0
  description: >
    The remote service accepts connections encrypted using TLS 1.0. TLS 1.0 has a
    number of cryptographic design flaws. Modern implementations of TLS 1.0
    mitigate these problems, but newer versions of TLS like 1.1 and 1.2 are
    designed against these flaws and should be used whenever possible.

    PCI DSS v3.2 requires that TLS 1.0 be disabled entirely by June 30,
    2018, except for POS POI terminals (and the SSL/TLS termination
    points to which they connect) that can be verified as not being
    susceptible to any known exploits.
  recommendations: RAW=ARRAY['Enable support for TLS 1.1 and 1.2, and disable support for TLS 1.0.']
  reference_links: 

- id: fb1da6a6-f590-40ae-9cee-a6079293a629
  summary: Nessus SYN scanner
  cwe_id: 0
  description: >
    This plugin is a SYN 'half-open' port scanner.  It shall be reasonably
    quick even against a firewalled target. 

    Note that SYN scans are less intrusive than TCP (full connect) scans
    against broken services, but they might cause problems for less robust
    firewalls and also leave unclosed connections on the remote target, if
    the network is loaded.
  recommendations: RAW=ARRAY['Protect your target with an IP filter.']
  reference_links: 

- id: c3ac0598-0422-4651-9410-222193c9b7ca
  summary: HTTP X-XSS-Protection Not Implemented
  cwe_id: 358
  description: \`X-XSS-Protection\` is a feature of Internet Explorer and Chrome that stops pages from loading when they detect reflected cross-site scripting (XSS) attacks. Although these protections are largely unnecessary in modern browsers when sites implement a strong Content Security Policy that disables the use of inline JavaScript (\`unsafe-inline\`), they can still provide protections for users of older web browsers that don't yet support CSP.
  recommendations: RAW=ARRAY['New websites should use this header, but given the small risk of false positives, it is only recommended for existing sites.', 'This header is unnecessary for APIs, which should instead simply return a restrictive Content Security Policy header.']
  reference_links: RAW=ARRAY['https://wiki.mozilla.org/Security/Guidelines/Web_Security#X-XSS-Protection', 'https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection', 'https://observatory.mozilla.org/']

- id: 052db4ae-e7c8-4298-869f-aa365729ffd6
  summary: A fancy new issue
  cwe_id: 0
  description: This issues is totally new and was not defined before.
  recommendations: RAW=ARRAY['Fix']
  reference_links: RAW=ARRAY['https://test.example.com/check_docs']
